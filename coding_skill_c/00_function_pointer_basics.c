/*
 * ============================================================================
 * νμΌλ…: 00_function_pointer_basics.c
 * κΈ°λ¥: Cμ–Έμ–΄ ν•¨μ ν¬μΈν„°(Function Pointer) μ™„μ „ μ •λ³µ
 * 
 * μ΄ νμΌμ λ©μ :
 *   - ν•¨μ ν¬μΈν„°λ¥Ό μ²μ λ°°μ°λ” μ‚¬λλ„ μ΄ν•΄ν•  μ μλ„λ΅
 *   - λ‹¨κ³„λ³„λ΅ λ‚μ΄λ„λ¥Ό λ†’μ—¬κ°€λ©° μ„¤λ…
 *   - μ‹¤ν–‰ κ°€λ¥ν• μμ λ΅ μ§μ ‘ ν™•μΈ
 *   - μ‹¤λ¬΄μ—μ„ μ–΄λ–»κ² μ‚¬μ©λλ”μ§€ μ΄ν•΄
 * 
 * ============================================================================
 * π“ ν•™μµ λ©μ°¨
 * ============================================================================
 * 
 * 1λ‹¨κ³„: ν•¨μ ν¬μΈν„°κ°€ λ­”κ°€μ”? (κΈ°μ΄ κ°λ…)
 * 2λ‹¨κ³„: ν•¨μ ν¬μΈν„° μ„ μ–Έν•κΈ°
 * 3λ‹¨κ³„: ν•¨μ ν¬μΈν„° μ‚¬μ©ν•κΈ°
 * 4λ‹¨κ³„: typedefλ΅ κ°„λ‹¨ν•κ² λ§λ“¤κΈ°
 * 5λ‹¨κ³„: ν•¨μ ν¬μΈν„° λ°°μ—΄
 * 6λ‹¨κ³„: μ½λ°± ν•¨μ (Callback)
 * 7λ‹¨κ³„: κµ¬μ΅°μ²΄μ™€ ν•¨μ ν¬μΈν„°
 * 8λ‹¨κ³„: μ‹¤λ¬΄ μμ  (κ³„μ‚°κΈ°, λ…λ Ή ν…μ΄λΈ”, μƒνƒ λ¨Έμ‹ )
 * 9λ‹¨κ³„: λ€λΉ„ ν¬μΈνΈ
 * 
 * ============================================================================
 */

#include <stdio.h>
#include <stdlib.h>
#include <string.h>

/* ============================================================================
 * 1λ‹¨κ³„: ν•¨μ ν¬μΈν„°κ°€ λ­”κ°€μ”?
 * ============================================================================
 * 
 * π’΅ ν•µμ‹¬ κ°λ…:
 * 
 *   "ν•¨μ ν¬μΈν„°λ” ν•¨μμ μ£Όμ†λ¥Ό μ €μ¥ν•λ” λ³€μμ…λ‹λ‹¤"
 * 
 *   int x = 10;       // xλ” μ •μ 10μ„ μ €μ¥
 *   int* p = &x;      // pλ” λ³€μ xμ μ£Όμ†λ¥Ό μ €μ¥
 *   
 *   void func();      // funcλ” ν•¨μ
 *   void (*fp)();     // fpλ” ν•¨μμ μ£Όμ†λ¥Ό μ €μ¥ β† ν•¨μ ν¬μΈν„°!
 * 
 * β“ μ™ ν•„μ”ν•κ°€?
 * 
 *   1. λ°νƒ€μ„μ— νΈμ¶ν•  ν•¨μλ¥Ό μ„ νƒν•  μ μμ
 *   2. μ½λ°± ν•¨μ κµ¬ν„
 *   3. ν•¨μ ν…μ΄λΈ” κµ¬ν„
 *   4. λ‹¤ν•μ„±(Polymorphism) κµ¬ν„
 * 
 * ============================================================================
 */

/* μμ λ¥Ό μ„ν• κ°„λ‹¨ν• ν•¨μλ“¤ */
void HelloWorld(void) {
    printf("Hello, World!\n");
}

void Goodbye(void) {
    printf("Goodbye!\n");
}

void Step1_Concept(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  1λ‹¨κ³„: ν•¨μ ν¬μΈν„° κ°λ… μ΄ν•΄ν•κΈ°\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    /* μΌλ°μ μΈ ν•¨μ νΈμ¶ */
    printf("[μΌλ° νΈμ¶] ");
    HelloWorld();
    
    /* ν•¨μμ μ£Όμ† μ¶λ ¥ */
    printf("\n[ν•¨μ μ£Όμ†]\n");
    printf("  HelloWorld ν•¨μμ μ£Όμ†: %p\n", (void*)HelloWorld);
    printf("  Goodbye ν•¨μμ μ£Όμ†: %p\n", (void*)Goodbye);

    printf("\nπ’΅ ν•¨μλ„ λ©”λ¨λ¦¬ μ–΄λ”κ°€μ— μ €μ¥λμ–΄ μμ–΄μ”!\n");
    printf("   μ΄ μ£Όμ†λ¥Ό λ³€μμ— μ €μ¥ν•  μ μλ‹¤λ©΄?\n");
    printf("   β†’ λ°”λ΅ 'ν•¨μ ν¬μΈν„°'μ…λ‹λ‹¤!\n");
}

/* ============================================================================
 * 2λ‹¨κ³„: ν•¨μ ν¬μΈν„° μ„ μ–Έν•κΈ°
 * ============================================================================
 * 
 * π“ κΈ°λ³Έ λ¬Έλ²•:
 * 
 *   λ°ν™νƒ€μ… (*ν¬μΈν„°μ΄λ¦„)(λ§¤κ°λ³€μνƒ€μ…1, λ§¤κ°λ³€μνƒ€μ…2, ...);
 * 
 * μμ :
 *   void (*fp)(void);              // void λ°ν™, λ§¤κ°λ³€μ μ—†μ
 *   int (*fp)(int, int);           // int λ°ν™, int 2κ° λ§¤κ°λ³€μ
 *   float (*fp)(double);           // float λ°ν™, double 1κ° λ§¤κ°λ³€μ
 * 
 * β οΈ μ£Όμ: κ΄„νΈκ°€ μ¤‘μ”ν•©λ‹λ‹¤!
 * 
 *   void (*fp)(void);   β… ν•¨μ ν¬μΈν„°
 *   void *fp(void);     β void*λ¥Ό λ°ν™ν•λ” ν•¨μ (ν•¨μ ν¬μΈν„° μ•„λ‹!)
 * 
 * ============================================================================
 */

/* λ§¤κ°λ³€μκ°€ μ—†λ” ν•¨μλ“¤ */
void PrintA(void) { printf("A\n"); }
void PrintB(void) { printf("B\n"); }

/* λ§¤κ°λ³€μκ°€ μλ” ν•¨μλ“¤ */
int Add(int a, int b) { return a + b; }
int Subtract(int a, int b) { return a - b; }
int Multiply(int a, int b) { return a * b; }

void Step2_Declaration(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  2λ‹¨κ³„: ν•¨μ ν¬μΈν„° μ„ μ–Έν•κΈ°\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    /* μμ  1: λ§¤κ°λ³€μ μ—†λ” ν•¨μ ν¬μΈν„° */
    printf("[μμ  1] void (*fp)(void)\n");
    void (*simple_fp)(void);  // μ„ μ–Έ
    
    simple_fp = PrintA;       // ν•¨μ μ£Όμ† λ€μ… (& μƒλµ κ°€λ¥)
    printf("  ν•¨μ ν¬μΈν„° νΈμ¶: ");
    simple_fp();              // ν•¨μ νΈμ¶ (PrintA μ‹¤ν–‰λ¨)
    
    simple_fp = PrintB;       // λ‹¤λ¥Έ ν•¨μλ΅ λ³€κ²½
    printf("  ν•¨μ ν¬μΈν„° νΈμ¶: ");
    simple_fp();              // PrintB μ‹¤ν–‰λ¨
    
    /* μμ  2: λ§¤κ°λ³€μ μλ” ν•¨μ ν¬μΈν„° */
    printf("\n[μμ  2] int (*fp)(int, int)\n");
    int (*calc_fp)(int, int);  // μ„ μ–Έ
    
    calc_fp = Add;
    printf("  10 + 5 = %d\n", calc_fp(10, 5));
    
    calc_fp = Multiply;
    printf("  10 * 5 = %d\n", calc_fp(10, 5));
    
    printf("\nπ’΅ ν•¨μ ν¬μΈν„°λ΅ λ°νƒ€μ„μ— νΈμ¶ν•  ν•¨μλ¥Ό λ°”κΏ€ μ μμ–΄μ”!\n");
}

/* ============================================================================
 * 3λ‹¨κ³„: ν•¨μ ν¬μΈν„° μ‚¬μ©ν•κΈ° (λ” μμ„Έν)
 * ============================================================================
 * 
 * π“ ν•¨μ ν¬μΈν„° μ‚¬μ© 4λ‹¨κ³„:
 * 
 *   1οΈβƒ£ ν•¨μ μ •μ
 *   2οΈβƒ£ ν•¨μ ν¬μΈν„° μ„ μ–Έ
 *   3οΈβƒ£ ν•¨μ μ£Όμ† λ€μ…
 *   4οΈβƒ£ ν•¨μ ν¬μΈν„°λ΅ νΈμ¶
 * 
 * ============================================================================
 */

void PrintSquare(int n) {
    printf("  %dμ μ κ³± = %d\n", n, n * n);
}

void PrintCube(int n) {
    printf("  %dμ μ„Έμ κ³± = %d\n", n, n * n * n);
}

void Step3_Usage(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  3λ‹¨κ³„: ν•¨μ ν¬μΈν„° μ‚¬μ© ν¨ν„΄\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    /* 1οΈβƒ£ ν•¨μ μ •μ - μ„μ— μ΄λ―Έ μ •μλ¨ (PrintSquare, PrintCube) */
    
    /* 2οΈβƒ£ ν•¨μ ν¬μΈν„° μ„ μ–Έ */
    void (*operation)(int);
    
    /* 3οΈβƒ£ ν•¨μ μ£Όμ† λ€μ… */
    operation = PrintSquare;
    
    /* 4οΈβƒ£ ν•¨μ ν¬μΈν„°λ΅ νΈμ¶ */
    printf("[λ°©λ²• 1] operation = PrintSquare\n");
    operation(5);
    
    /* λ‹¤λ¥Έ ν•¨μλ΅ κµμ²΄ */
    operation = PrintCube;
    printf("\n[λ°©λ²• 2] operation = PrintCube\n");
    operation(5);
    
    /* λ‹¤μ–‘ν• νΈμ¶ λ°©λ²• */
    printf("\n[ν•¨μ ν¬μΈν„° νΈμ¶ λ°©λ²• 3κ°€μ§€]\n");
    operation = PrintSquare;
    
    printf("1. operation(3)     β†’ ");
    operation(3);
    
    printf("2. (*operation)(4)  β†’ ");
    (*operation)(4);
    
    printf("3. (&operation)(5)λ” λ¶κ°€λ¥\n");
    
    printf("\nπ’΅ λ³΄ν†µμ€ operation(n) ν•νƒλ΅ μ‚¬μ©ν•΄μ”!\n");
}

/* ============================================================================
 * 4λ‹¨κ³„: typedefλ΅ κ°„λ‹¨ν•κ² λ§λ“¤κΈ°
 * ============================================================================
 * 
 * π° λ¬Έμ : ν•¨μ ν¬μΈν„° λ¬Έλ²•μ΄ λ³µμ΅ν•΄μ”!
 * 
 *   void (*fp1)(int);
 *   void (*fp2)(int);
 *   void (*fp3)(int);
 *   
 *   β†’ λ§¤λ² μ΄λ ‡κ² μ“°κΈ° κ·€μ°®μ•„μ”!
 * 
 * π ν•΄κ²°: typedefλ¥Ό μ‚¬μ©ν•μ„Έμ”!
 * 
 *   typedef void (*Operation)(int);
 *   
 *   Operation fp1;
 *   Operation fp2;
 *   Operation fp3;
 *   
 *   β†’ ν›¨μ”¬ κ°„λ‹¨ν•κ³  μ½κΈ° μ‰¬μ›μ”!
 * 
 * ============================================================================
 */

/* typedefλ΅ ν•¨μ ν¬μΈν„° νƒ€μ… μ •μ */
typedef void (*PrintFunc)(const char* msg);
typedef int (*CalcFunc)(int, int);

void PrintMessage(const char* msg) {
    printf("  λ©”μ‹μ§€: %s\n", msg);
}

void PrintError(const char* msg) {
    printf("  [ERROR] %s\n", msg);
}

void Step4_Typedef(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  4λ‹¨κ³„: typedefλ΅ κΉ”λ”ν•κ²!\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    /* typedef μ—†μ΄ μ‚¬μ© */
    printf("[typedef μ—†μ΄]\n");
    void (*printer1)(const char*);
    printer1 = PrintMessage;
    printer1("μ•λ…•ν•μ„Έμ”");
    
    /* typedef μ‚¬μ© */
    printf("\n[typedef μ‚¬μ©]\n");
    PrintFunc printer2;  // ν›¨μ”¬ κ°„λ‹¨!
    printer2 = PrintMessage;
    printer2("μ•λ…•ν•μ„Έμ”");
    
    printer2 = PrintError;
    printer2("μ¤λ¥ λ°μƒ!");
    
    /* κ³„μ‚° ν•¨μ typedef */
    printf("\n[κ³„μ‚° ν•¨μ]\n");
    CalcFunc calc;
    
    calc = Add;
    printf("  100 + 50 = %d\n", calc(100, 50));
    
    calc = Multiply;
    printf("  100 * 50 = %d\n", calc(100, 50));
    
    printf("\nπ’΅ typedefλ¥Ό μ“°λ©΄ μ½”λ“κ°€ ν›¨μ”¬ μ½κΈ° μ‰¬μ›μ Έμ”!\n");
}

/* ============================================================================
 * 5λ‹¨κ³„: ν•¨μ ν¬μΈν„° λ°°μ—΄
 * ============================================================================
 * 
 * π― ν•¨μ ν¬μΈν„°λ¥Ό λ°°μ—΄λ΅ λ§λ“¤ μ μμ–΄μ”!
 * 
 *   ν•¨μν¬μΈν„°νƒ€μ… λ°°μ—΄μ΄λ¦„[ν¬κΈ°];
 * 
 * π’Ό μ‹¤λ¬΄ ν™μ©:
 *   - λ…λ Ή ν…μ΄λΈ”
 *   - λ©”λ‰΄ μ‹μ¤ν…
 *   - μ΄λ²¤νΈ ν•Έλ“¤λ¬
 * 
 * ============================================================================
 */

void Level1(void) { printf("    λ λ²¨ 1 μ‹¤ν–‰\n"); }
void Level2(void) { printf("    λ λ²¨ 2 μ‹¤ν–‰\n"); }
void Level3(void) { printf("    λ λ²¨ 3 μ‹¤ν–‰\n"); }
void Level4(void) { printf("    λ λ²¨ 4 μ‹¤ν–‰\n"); }
void Level5(void) { printf("    λ λ²¨ 5 μ‹¤ν–‰\n"); }

typedef void (*LevelFunc)(void);

void Step5_Array(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  5λ‹¨κ³„: ν•¨μ ν¬μΈν„° λ°°μ—΄\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    /* ν•¨μ ν¬μΈν„° λ°°μ—΄ μƒμ„± */
    LevelFunc levels[5] = {
        Level1,
        Level2,
        Level3,
        Level4,
        Level5
    };
    
    printf("[κ²μ„ λ λ²¨ μ‹¤ν–‰]\n");
    for (int i = 0; i < 5; i++) {
        printf("  λ λ²¨ %d β†’ ", i + 1);
        levels[i]();  // λ°°μ—΄ μΈλ±μ¤λ΅ ν•¨μ νΈμ¶!
    }
    
    /* κ³„μ‚°κΈ° μμ  */
    printf("\n[κ°„λ‹¨ν• κ³„μ‚°κΈ°]\n");
    CalcFunc operations[3] = { Add, Subtract, Multiply };
    const char* op_names[3] = { "λ§μ…", "λΊ„μ…", "κ³±μ…" };
    
    int a = 20, b = 4;
    for (int i = 0; i < 3; i++) {
        printf("  %s: %d κ²°κ³Ό = %d\n", 
               op_names[i], a, operations[i](a, b));
    }
    
    printf("\nπ’΅ ν•¨μ ν¬μΈν„° λ°°μ—΄λ΅ μΈλ±μ¤λ§ λ°”κΏ”μ„ λ‹¤λ¥Έ ν•¨μ νΈμ¶!\n");
}

/* ============================================================================
 * 6λ‹¨κ³„: μ½λ°± ν•¨μ (Callback)
 * ============================================================================
 * 
 * π― μ½λ°±μ΄λ€?
 * 
 *   "λ‹¤λ¥Έ ν•¨μμ— ν•¨μ ν¬μΈν„°λ¥Ό μ „λ‹¬ν•΄μ„, κ·Έ ν•¨μκ°€ λ‚μ¤‘μ— νΈμ¶ν•κ² ν•λ” κ²ƒ"
 * 
 * μμ‹:
 *   void ProcessData(int data, void (*callback)(int)) {
 *       // λ°μ΄ν„° μ²λ¦¬...
 *       callback(data);  // μ²λ¦¬ μ™„λ£ ν›„ μ½λ°± νΈμ¶
 *   }
 * 
 * π’Ό μ‹¤λ¬΄ ν™μ©:
 *   - μ΄λ²¤νΈ ν•Έλ“¤λ¬
 *   - λΉ„λ™κΈ° μ²λ¦¬
 *   - μΈν„°λ½νΈ ν•Έλ“¤λ¬
 * 
 * ============================================================================
 */

/* μ½λ°± ν•¨μλ“¤ */
void OnSuccess(int result) {
    printf("    β… μ„±κ³µ! κ²°κ³Ό: %d\n", result);
}

void OnError(int error_code) {
    printf("    β μ¤λ¥! μ½”λ“: %d\n", error_code);
}

/* μ½λ°±μ„ λ°›λ” ν•¨μ */
void ProcessTask(int value, void (*callback)(int)) {
    printf("    μ‘μ—… μ²λ¦¬ μ¤‘... (κ°’: %d)\n", value);
    
    // μ‘μ—… μ²λ¦¬ μ‹λ®¬λ μ΄μ…
    if (value > 0) {
        callback(value * 2);  // μ„±κ³µ μ½λ°±
    } else {
        callback(-1);  // μ¤λ¥ μ½λ°±
    }
}

/* λ°°μ—΄ μ •λ ¬ μμ  (qsort μ¤νƒ€μΌ) */
int CompareAsc(const void* a, const void* b) {
    return (*(int*)a - *(int*)b);
}

int CompareDesc(const void* a, const void* b) {
    return (*(int*)b - *(int*)a);
}

void SimpleSortAndPrint(int* arr, int size, int (*compare)(const void*, const void*)) {
    // κ°„λ‹¨ν• λ²„λΈ” μ •λ ¬
    for (int i = 0; i < size - 1; i++) {
        for (int j = 0; j < size - i - 1; j++) {
            if (compare(&arr[j], &arr[j + 1]) > 0) {
                int temp = arr[j];
                arr[j] = arr[j + 1];
                arr[j + 1] = temp;
            }
        }
    }
    
    // μ¶λ ¥
    printf("    ");
    for (int i = 0; i < size; i++) {
        printf("%d ", arr[i]);
    }
    printf("\n");
}

void Step6_Callback(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  6λ‹¨κ³„: μ½λ°± ν•¨μ (Callback)\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    /* κΈ°λ³Έ μ½λ°± μμ  */
    printf("[μμ  1] μ„±κ³µ/μ‹¤ν¨ μ½λ°±\n");
    ProcessTask(10, OnSuccess);
    ProcessTask(-5, OnError);
    
    /* μ •λ ¬ μ½λ°± μμ  */
    printf("\n[μμ  2] μ •λ ¬ λ°©μ‹μ„ μ½λ°±μΌλ΅ μ„ νƒ\n");
    int numbers1[] = {5, 2, 8, 1, 9};
    int numbers2[] = {5, 2, 8, 1, 9};
    
    printf("  μ¤λ¦„μ°¨μ: ");
    SimpleSortAndPrint(numbers1, 5, CompareAsc);
    
    printf("  λ‚΄λ¦Όμ°¨μ: ");
    SimpleSortAndPrint(numbers2, 5, CompareDesc);
    
    printf("\nπ’΅ μ½λ°±μΌλ΅ ν•¨μμ λ™μ‘μ„ μ μ—°ν•κ² μ»¤μ¤ν„°λ§μ΄μ§•!\n");
}

/* ============================================================================
 * 7λ‹¨κ³„: κµ¬μ΅°μ²΄μ™€ ν•¨μ ν¬μΈν„°
 * ============================================================================
 * 
 * π― κµ¬μ΅°μ²΄μ— ν•¨μ ν¬μΈν„°λ¥Ό λ„£μΌλ©΄?
 * 
 *   β†’ Cμ—μ„ κ°μ²΄ μ§€ν–¥ ν”„λ΅κ·Έλλ°μ²λΌ μ‚¬μ© κ°€λ¥!
 *   β†’ λ‹¤ν•μ„±(Polymorphism) κµ¬ν„!
 * 
 * π’Ό μ‹¤λ¬΄ ν™μ©:
 *   - λ“λΌμ΄λ²„ μΈν„°νμ΄μ¤
 *   - κ°€μƒ ν•¨μ ν…μ΄λΈ”
 *   - ν”λ¬κ·ΈμΈ μ‹μ¤ν…
 * 
 * ============================================================================
 */

/* λ™λ¬Ό κµ¬μ΅°μ²΄ (ν•¨μ ν¬μΈν„° ν¬ν•¨) */
typedef struct Animal {
    char name[32];
    void (*speak)(struct Animal* self);
    void (*move)(struct Animal* self);
} Animal;

/* κµ¬μ²΄μ μΈ λ™μ‘ ν•¨μλ“¤ */
void Dog_Speak(Animal* self) {
    printf("    %s: λ©λ©!\n", self->name);
}

void Dog_Move(Animal* self) {
    printf("    %s: λ„¤ λ°λ΅ λ‹¬λ¦½λ‹λ‹¤\n", self->name);
}

void Bird_Speak(Animal* self) {
    printf("    %s: μ§Ήμ§Ή!\n", self->name);
}

void Bird_Move(Animal* self) {
    printf("    %s: λ‚ μ•„κ°‘λ‹λ‹¤\n", self->name);
}

/* λ™λ¬Ό μƒμ„± ν•¨μ */
Animal CreateDog(const char* name) {
    Animal dog;
    strcpy(dog.name, name);
    dog.speak = Dog_Speak;
    dog.move = Dog_Move;
    return dog;
}

Animal CreateBird(const char* name) {
    Animal bird;
    strcpy(bird.name, name);
    bird.speak = Bird_Speak;
    bird.move = Bird_Move;
    return bird;
}

void Step7_StructWithFP(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  7λ‹¨κ³„: κµ¬μ΅°μ²΄ + ν•¨μ ν¬μΈν„°\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    /* λ™λ¬Ό κ°μ²΄ μƒμ„± */
    Animal dog = CreateDog("λ°”λ‘‘μ΄");
    Animal bird = CreateBird("μ§Ήμ§Ήμ΄");
    
    /* κ°™μ€ μΈν„°νμ΄μ¤λ΅ λ‹¤λ¥Έ λ™μ‘! (λ‹¤ν•μ„±) */
    printf("[λ™λ¬Όλ“¤μ ν–‰λ™]\n");
    
    dog.speak(&dog);
    dog.move(&dog);
    
    printf("\n");
    
    bird.speak(&bird);
    bird.move(&bird);
    
    /* λ°°μ—΄λ΅ κ΄€λ¦¬ */
    printf("\n[λ™λ¬Όμ› ν¬μ–΄]\n");
    Animal zoo[2] = { dog, bird };
    
    for (int i = 0; i < 2; i++) {
        zoo[i].speak(&zoo[i]);
        zoo[i].move(&zoo[i]);
        printf("\n");
    }
    
    printf("π’΅ Cλ΅λ„ κ°μ²΄μ§€ν–¥μ²λΌ λ‹¤ν•μ„±μ„ κµ¬ν„ν•  μ μμ–΄μ”!\n");
}

/* ============================================================================
 * 8λ‹¨κ³„: μ‹¤λ¬΄ μμ 
 * ============================================================================
 */

/* 8-1. κ³„μ‚°κΈ° */
typedef int (*MathOperation)(int, int);

typedef struct {
    char symbol;
    MathOperation func;
    const char* name;
} Calculator;

int Divide(int a, int b) {
    return b != 0 ? a / b : 0;
}

void Demo_Calculator(void) {
    printf("\n[μ‹¤λ¬΄ μμ  1] ν™•μ¥ κ°€λ¥ν• κ³„μ‚°κΈ°\n");
    
    Calculator calc_table[] = {
        { '+', Add, "λ§μ…" },
        { '-', Subtract, "λΊ„μ…" },
        { '*', Multiply, "κ³±μ…" },
        { '/', Divide, "λ‚λ—μ…" }
    };
    
    int a = 20, b = 4;
    int table_size = sizeof(calc_table) / sizeof(calc_table[0]);
    
    for (int i = 0; i < table_size; i++) {
        printf("  %d %c %d = %d (%s)\n", 
               a, calc_table[i].symbol, b,
               calc_table[i].func(a, b),
               calc_table[i].name);
    }
}

/* 8-2. λ…λ Ή ν…μ΄λΈ” (μ„λ² λ””λ“ μ‹μ¤ν…) */
typedef void (*CommandHandler)(int param);

void CMD_Reset(int param) {
    printf("    μ‹μ¤ν… λ¦¬μ…‹ μ‹¤ν–‰\n");
}

void CMD_Start(int param) {
    printf("    μ‹μ¤ν… μ‹μ‘ (νλΌλ―Έν„°: %d)\n", param);
}

void CMD_Stop(int param) {
    printf("    μ‹μ¤ν… μ •μ§€\n");
}

typedef struct {
    int command_id;
    CommandHandler handler;
    const char* description;
} Command;

void Demo_CommandTable(void) {
    printf("\n[μ‹¤λ¬΄ μμ  2] λ…λ Ή ν…μ΄λΈ” (μ„λ² λ””λ“)\n");
    
    Command cmd_table[] = {
        { 0x01, CMD_Reset, "μ‹μ¤ν… λ¦¬μ…‹" },
        { 0x02, CMD_Start, "μ‹μ¤ν… μ‹μ‘" },
        { 0x03, CMD_Stop, "μ‹μ¤ν… μ •μ§€" }
    };
    
    int table_size = sizeof(cmd_table) / sizeof(cmd_table[0]);
    
    // λ…λ Ή μμ‹  μ‹λ®¬λ μ΄μ…
    int received_commands[] = { 0x02, 0x03, 0x01 };
    
    for (int i = 0; i < 3; i++) {
        int cmd_id = received_commands[i];
        printf("  λ…λ Ή μμ‹ : 0x%02X\n", cmd_id);
        
        // λ…λ Ή ν…μ΄λΈ”μ—μ„ μ°ΎκΈ°
        for (int j = 0; j < table_size; j++) {
            if (cmd_table[j].command_id == cmd_id) {
                cmd_table[j].handler(100);
                break;
            }
        }
    }
}

/* 8-3. κ°„λ‹¨ν• μƒνƒ λ¨Έμ‹  */
typedef enum {
    STATE_IDLE,
    STATE_RUNNING,
    STATE_STOPPED
} State;

typedef State (*StateFunc)(void);

State State_Idle(void) {
    printf("    [IDLE] λ€κΈ° μ¤‘...\n");
    return STATE_RUNNING;
}

State State_Running(void) {
    printf("    [RUNNING] μ‹¤ν–‰ μ¤‘...\n");
    return STATE_STOPPED;
}

State State_Stopped(void) {
    printf("    [STOPPED] μ •μ§€λ¨\n");
    return STATE_IDLE;
}

void Demo_StateMachine(void) {
    printf("\n[μ‹¤λ¬΄ μμ  3] μƒνƒ λ¨Έμ‹ \n");
    
    StateFunc state_table[] = {
        State_Idle,
        State_Running,
        State_Stopped
    };
    
    State current = STATE_IDLE;
    
    for (int i = 0; i < 6; i++) {
        printf("  Step %d:\n", i + 1);
        current = state_table[current]();
        printf("\n");
    }
}

void Step8_RealWorld(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  8λ‹¨κ³„: μ‹¤λ¬΄ μμ \n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    
    Demo_Calculator();
    Demo_CommandTable();
    Demo_StateMachine();
    
    printf("\nπ’΅ μ‹¤λ¬΄μ—μ„λ” μ΄λ ‡κ² ν•¨μ ν¬μΈν„°λ¥Ό ν™μ©ν•΄μ”!\n");
}

/* ============================================================================
 * 9λ‹¨κ³„: λ©΄μ ‘ λ€μ‘ ν¬μΈνΈ
 * ============================================================================
 */

void Step9_Interview(void) {
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  9λ‹¨κ³„: λ©΄μ ‘ λ€μ‘ ν¬μΈνΈ\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    
    printf("π“ λ©΄μ ‘μ—μ„ μμ£Ό λ‚μ¤λ” μ§λ¬Έλ“¤:\n\n");
    
    printf("Q1: ν•¨μ ν¬μΈν„°λ€ λ¬΄μ—‡μΈκ°€μ”?\n");
    printf("A1: ν•¨μμ μ£Όμ†λ¥Ό μ €μ¥ν•λ” ν¬μΈν„° λ³€μμ…λ‹λ‹¤.\n");
    printf("    λ°νƒ€μ„μ— νΈμ¶ν•  ν•¨μλ¥Ό λ™μ μΌλ΅ μ„ νƒν•  μ μκ² ν•΄μ¤λ‹λ‹¤.\n\n");
    
    printf("Q2: ν•¨μ ν¬μΈν„°λ” μ–Έμ  μ‚¬μ©ν•λ‚μ”?\n");
    printf("A2: 1) μ½λ°± ν•¨μ κµ¬ν„\n");
    printf("    2) μƒνƒ λ¨Έμ‹  κµ¬ν„\n");
    printf("    3) λ…λ Ή ν…μ΄λΈ” κµ¬ν„\n");
    printf("    4) ν”λ¬κ·ΈμΈ μ‹μ¤ν…\n");
    printf("    5) Cμ—μ„ λ‹¤ν•μ„± κµ¬ν„\n\n");
    
    printf("Q3: void (*fp)(int)μ™€ void *fp(int)μ μ°¨μ΄λ”?\n");
    printf("A3: void (*fp)(int)  β†’ ν•¨μ ν¬μΈν„° (intλ¥Ό λ°›μ•„ void λ°ν™ν•λ” ν•¨μ)\n");
    printf("    void *fp(int)    β†’ ν•¨μ (intλ¥Ό λ°›μ•„ void*λ¥Ό λ°ν™)\n");
    printf("    κ΄„νΈ μ„μΉκ°€ μ¤‘μ”ν•©λ‹λ‹¤!\n\n");
    
    printf("Q4: typedefλ¥Ό μ‚¬μ©ν•λ” μ΄μ λ”?\n");
    printf("A4: ν•¨μ ν¬μΈν„° λ¬Έλ²•μ΄ λ³µμ΅ν•΄μ„ typedefλ΅ νƒ€μ… λ³„μΉ­μ„ λ§λ“¤λ©΄\n");
    printf("    μ½”λ“ κ°€λ…μ„±μ΄ λ†’μ•„μ§€κ³  μ μ§€λ³΄μκ°€ μ‰¬μ›μ§‘λ‹λ‹¤.\n\n");
    
    printf("Q5: μ‹¤λ¬΄μ—μ„ μ‚¬μ©ν• κ²½ν—μ€?\n");
    printf("A5: (μμ‹ λ‹µλ³€)\n");
    printf("    \"UART ν†µμ‹  λ“λΌμ΄λ²„μ—μ„ λ°μ΄ν„° μμ‹  μ™„λ£ μ‹ μ½λ°± ν•¨μλ¥Ό\n");
    printf("     νΈμ¶ν•λ„λ΅ κµ¬ν„ν–μµλ‹λ‹¤. μ΄λ¥Ό ν†µν•΄ μƒμ„ λ μ΄μ–΄μ—μ„\n");
    printf("     μμ‹  μ΄λ²¤νΈλ¥Ό μ μ—°ν•κ² μ²λ¦¬ν•  μ μμ—μµλ‹λ‹¤.\"\n\n");
    
    printf("π’΅ λ©΄μ ‘ ν:\n");
    printf("   - κ°λ…μ„ λ…ν™•ν μ„¤λ…\n");
    printf("   - μ‹¤λ¬΄ κ²½ν—κ³Ό μ—°κ²°\n");
    printf("   - κ°„λ‹¨ν• μμ  μ½”λ“ μ‘μ„± κ°€λ¥ν•΄μ•Ό ν•¨\n");
}

/* ============================================================================
 * λ©”μΈ ν•¨μ
 * ============================================================================
 */

int main(void) {
    printf("\n");
    printf("β•”β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•—\n");
    printf("β•‘                                                            β•‘\n");
    printf("β•‘     Cμ–Έμ–΄ ν•¨μ ν¬μΈν„° μ™„μ „ μ •λ³µ                            β•‘\n");
    printf("β•‘     Function Pointer Master Class                          β•‘\n");
    printf("β•‘                                                            β•‘\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    
    /* λ‹¨κ³„λ³„ μ‹¤ν–‰ */
    Step1_Concept();
    Step2_Declaration();
    Step3_Usage();
    Step4_Typedef();
    Step5_Array();
    Step6_Callback();
    Step7_StructWithFP();
    Step8_RealWorld();
    Step9_Interview();
    
    /* λ§λ¬΄λ¦¬ */
    printf("\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n");
    printf("  π‰ μ¶•ν•ν•©λ‹λ‹¤!\n");
    printf("β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•\n\n");
    printf("ν•¨μ ν¬μΈν„°μ λ¨λ“  κ²ƒμ„ ν•™μµν–μµλ‹λ‹¤!\n\n");
    printf("π“ λ‹¤μ ν•™μµ λ‹¨κ³„:\n");
    printf("   1. 04_callback_pattern.c - μ½λ°± ν¨ν„΄ μ‹¬ν™”\n");
    printf("   2. 05_state_machine.c - μƒνƒ λ¨Έμ‹  ν¨ν„΄\n");
    printf("   3. 06_factory_pattern.c - ν©ν† λ¦¬ ν¨ν„΄\n");
    printf("   4. 07_observer_pattern.c - μµμ €λ²„ ν¨ν„΄\n\n");
    
    return 0;
}

/*
 * ============================================================================
 * π― ν•™μµ μ”μ•½
 * ============================================================================
 * 
 * β… ν•¨μ ν¬μΈν„°λ€?
 *    β†’ ν•¨μμ μ£Όμ†λ¥Ό μ €μ¥ν•λ” λ³€μ
 * 
 * β… κΈ°λ³Έ λ¬Έλ²•:
 *    λ°ν™νƒ€μ… (*ν¬μΈν„°μ΄λ¦„)(λ§¤κ°λ³€μνƒ€μ…λ“¤);
 * 
 * β… typedef ν™μ©:
 *    typedef λ°ν™νƒ€μ… (*νƒ€μ…μ΄λ¦„)(λ§¤κ°λ³€μνƒ€μ…λ“¤);
 * 
 * β… μ£Όμ” ν™μ©:
 *    - μ½λ°± ν•¨μ
 *    - ν•¨μ ν¬μΈν„° λ°°μ—΄
 *    - κµ¬μ΅°μ²΄μ— ν•¨μ ν¬μΈν„°
 *    - λ…λ Ή ν…μ΄λΈ”
 *    - μƒνƒ λ¨Έμ‹ 
 * 
 * ============================================================================
 * π”§ μ»΄νμΌ λ° μ‹¤ν–‰
 * ============================================================================
 * 
 * μ»΄νμΌ:
 *   gcc -o 00_function_pointer.exe 00_function_pointer_basics.c -Wall
 * 
 * μ‹¤ν–‰:
 *   00_function_pointer.exe
 * 
 * ============================================================================
 * π“ μ¶”κ°€ ν•™μµ μλ£
 * ============================================================================
 * 
 * μ΄ νμΌμ„ μ™„μ „ν μ΄ν•΄ν–λ‹¤λ©΄:
 * 
 * 1. λ‹¤λ¥Έ λ””μμΈ ν¨ν„΄ νμΌλ“¤ (01-31λ²) ν•™μµ
 * 2. μ‹¤μ  ν”„λ΅μ νΈμ— μ μ© (μ„Όμ„ λ“λΌμ΄λ²„, ν†µμ‹  μ¤νƒ λ“±)
 * 3. FreeRTOS μ†μ¤ μ½”λ“ λ¶„μ„
 * 4. Linux Kernel λ“λΌμ΄λ²„ μ½”λ“ λ¶„μ„
 * 
 * ============================================================================
 * π’΅ λ§μ§€λ§‰ ν
 * ============================================================================
 * 
 * ν•¨μ ν¬μΈν„°λ” μ²μμ—λ” μ–΄λ ¤μ› λ³΄μ΄μ§€λ§,
 * λ‡ λ² μ—°μµν•λ©΄ μμ—°μ¤λ½κ² μ‚¬μ©ν•  μ μμµλ‹λ‹¤!
 * 
 * ν•µμ‹¬μ€:
 * 1. λ¬Έλ²• μ΄ν•΄ (κ΄„νΈ μ„μΉ!)
 * 2. typedef ν™μ© (κ°€λ…μ„±!)
 * 3. μ‹¤λ¬΄ ν¨ν„΄ μ™μ§€ (μ½λ°±, ν…μ΄λΈ”, μƒνƒ λ¨Έμ‹ )
 * 
 * ν™”μ΄ν…! π€
 * 
 * ============================================================================
 */
